(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-332a4e41"],{"4c89":function(t,e,n){"use strict";n("7bfc")},"7bfc":function(t,e,n){},f87e:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[t._v("分组列表信息")]),n("lin-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{tableColumn:t.tableColumn,tableData:t.tableData,operate:t.operate},on:{handleEdit:t.handleEdit,handleDelete:t.handleDelete,"row-click":t.rowClick}}),n("el-dialog",{staticClass:"groupListInfoDialog",attrs:{"append-to-body":!0,visible:t.dialogFormVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("div",{staticStyle:{"margin-top":"-25px"}},[n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("el-tab-pane",{staticStyle:{"margin-top":"10px"},attrs:{label:"修改信息",name:"修改信息"}},[t.dialogFormVisible?n("el-form",{ref:"form",staticStyle:{"margin-left":"-35px","margin-bottom":"-35px","margin-top":"15px"},attrs:{"status-icon":"","label-width":"120px",model:t.form,"label-position":"labelPosition",rules:t.rules}},[n("el-form-item",{attrs:{label:"分组名称",prop:"name"}},[n("el-input",{attrs:{size:"medium",clearable:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"分组描述",prop:"info"}},[n("el-input",{attrs:{size:"medium",clearable:""},model:{value:t.form.info,callback:function(e){t.$set(t.form,"info",e)},expression:"form.info"}})],1)],1):t._e()],1),n("el-tab-pane",{staticStyle:{"margin-top":"10px"},attrs:{label:"配置权限",name:"配置权限"}},[t.dialogFormVisible?n("group-auths",{ref:"groupAuths",staticStyle:{"margin-right":"-30px","margin-left":"-25px","margin-bottom":"-10px"},attrs:{id:t.id},on:{updateAuths:t.updateAuths,updateCacheAuths:t.updateCacheAuths,updateAllAuths:t.updateAllAuths}}):t._e()],1)],1)],1),n("div",{staticClass:"dialog-footer",staticStyle:{"padding-left":"5px"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.confirmEdit}},[t._v("确 定")]),n("el-button",{on:{click:function(e){return t.resetForm("form")}}},[t._v("重 置")])],1)])],1)},a=[],i=n("a34a"),s=n.n(i),o=n("306b"),c=n("4723"),l=n("6e10"),u=n("1342");function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(n,!0).forEach(function(e){p(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){return g(t)||b(t)||m()}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function b(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function g(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function v(t,e,n,r,a,i,s){try{var o=t[i](s),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(r,a)}function x(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function s(t){v(i,r,a,s,o,"next",t)}function o(t){v(i,r,a,s,o,"throw",t)}s(void 0)})}}var y={components:{LinTable:l["default"],GroupAuths:u["default"]},inject:["eventBus"],data:function(){return{id:0,tableData:[],tableColumn:[],operate:[],dialogFormVisible:!1,labelPosition:"right",form:{name:"",info:""},allAuths:{},auths:[],cacheAuths:[],cacheForm:{name:"",info:""},loading:!1,activeTab:"修改信息",rules:{name:[{required:!0,message:"请输入分组名称",trigger:"blur"}],info:[]}}},methods:{getAllGroups:function(){var t=x(s.a.mark(function t(){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,c["default"].getAllGroups();case 4:this.tableData=t.sent,this.loading=!1,t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),this.loading=!1,console.log(t.t0);case 12:case"end":return t.stop()}},t,this,[[0,8]])}));function e(){return t.apply(this,arguments)}return e}(),confirmEdit:function(){var t=x(s.a.mark(function t(){var e,n,r,a,i,o,l,u,h,f=this;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("修改信息"!==this.activeTab){t.next=11;break}if(""!==this.form.name){t.next=4;break}return this.$message.warning("请将信息填写完整"),t.abrupt("return");case 4:if(this.cacheForm.name===this.form.name&&this.cacheForm.info===this.form.info){t.next=9;break}return t.next=7,c["default"].updateOneGroup(this.form.name,this.form.info,this.id);case 7:e=t.sent,0===e.error_code&&(this.$message.success("".concat(e.msg)),this.getAllGroups());case 9:t.next=29;break;case 11:if(this.auths=this.auths.filter(function(t){return Object.keys(f.allAuths).indexOf(t)<0}),this.cacheAuths=this.cacheAuths.filter(function(t){return Object.keys(f.allAuths).indexOf(t)<0}),this.auths.sort().toString()===this.cacheAuths.sort().toString()){t.next=29;break}for(n=d(this.auths),r=this.cacheAuths,a={},i={},o=0;o<n.length;o++)for(l=0;l<this.cacheAuths.length;l++)n[o]===this.cacheAuths[l]&&n.splice(o,1);for(u=0;u<r.length;u++)for(h=0;h<this.auths.length;h++)r[u]===this.auths[h]&&r.splice(u,1);if(!(n.length>0)){t.next=24;break}return t.next=23,c["default"].dispatchAuths(this.id,n);case 23:a=t.sent;case 24:if(!(r.length>0)){t.next=28;break}return t.next=27,c["default"].removeAuths(this.id,r);case 27:i=t.sent;case 28:0!==a.error_code&&0!==i.error_code||this.$message.success("权限修改成功");case 29:this.dialogFormVisible=!1;case 30:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),resetForm:function(t){this.$refs[t].resetFields(),this.$refs.groupAuths.getGroupAuths()},handleEdit:function(t){var e;e=t.index>=0?t.row:t,this.id=e.id,this.form.name=e.name,this.form.info=e.info,this.cacheForm=f({},this.form),this.dialogFormVisible=!0},handleDelete:function(t){var e,n=this;this.$confirm("此操作将永久删除该分组, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(x(s.a.mark(function r(){return s.a.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,n.loading=!0,r.next=4,c["default"].deleteOneGroup(t.row.id);case 4:e=r.sent,r.next=11;break;case 7:r.prev=7,r.t0=r["catch"](0),n.loading=!1,console.log(r.t0);case 11:if(0!==e.error_code){r.next=17;break}return r.next=14,n.getAllGroups();case 14:n.$message({type:"success",message:"".concat(e.msg)}),r.next=19;break;case 17:n.loading=!1,n.$message({type:"error",message:"".concat(e.msg)});case 19:case"end":return r.stop()}},r,null,[[0,7]])})))},rowClick:function(t){this.handleEdit(t)},initModuleCheck:function(t){var e=Object.keys(this.allAuths[t]),n=o["default"].getIntersect(e,this.auths);n.length===e.length&&this.auths.push(t)},updateCacheAuths:function(t){this.cacheAuths=t},updateAuths:function(t){this.auths=t},updateAllAuths:function(t){this.allAuths=t},handleClose:function(t){t()},handleClick:function(t){this.activeTab=t.name},addGroup:function(){var t=x(s.a.mark(function t(e){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!0!==e){t.next=3;break}return t.next=3,this.getAllGroups();case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},created:function(){var t=x(s.a.mark(function t(){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getAllGroups();case 2:this.tableColumn=[{prop:"name",label:"名称"},{prop:"info",label:"信息"}],this.operate=[{name:"编辑",func:"handleEdit",type:"primary"},{name:"删除",func:"handleDelete",type:"danger"}],this.eventBus.$on("addGroup",this.addGroup);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),beforeDestroy:function(){this.eventBus.$off("addUser",this.addGroup)}},w=y,A=(n("4c89"),n("2877")),k=Object(A["a"])(w,r,a,!1,null,"1abc1fce",null);e["default"]=k.exports}}]);