(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d4a3c31","chunk-2d0d3353"],{"0c77":function(e,t,r){},1732:function(e,t,r){"use strict";r("ee83")},"1a3a":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"wrap"},[r("el-row",[r("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"丢单原因"}},[r("el-input",{attrs:{size:"medium",disabled:"",placeholder:"请填写丢单原因"},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1),r("el-form-item",{attrs:{label:"审核状态",prop:"status"}},[r("el-switch",{attrs:{"active-text":"通过","inactive-text":"不通过","active-color":"#3963bc"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1),0==e.form.status||2==e.form.status?r("el-form-item",{attrs:{label:"驳回原因",prop:"result_reason"}},[r("el-input",{attrs:{type:"textarea",size:"medium",placeholder:"请填写驳回原因"},model:{value:e.form.result_reason,callback:function(t){e.$set(e.form,"result_reason",t)},expression:"form.result_reason"}})],1):e._e(),e.onlyRead?e._e():r("el-form-item",{staticClass:"submit"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitform("form")}}},[e._v("保 存")]),r("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重 置")])],1)],1)],1)],1)],1)])},a=[],i=r("a34a"),o=r.n(i),s=r("5c7f"),c=r("93c2");function u(e){return u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){l(i,n,a,o,s,"next",e)}function s(e){l(i,n,a,o,s,"throw",e)}o(void 0)})}}var p={name:"ProjectExamineAdd",props:{projectID:Number,editID:Number,onlyRead:{type:Boolean,default:!1}},watch:{},data:function(){var e=this,t=function(t,r,n){r||e.$refs.form.validateField("result_reason"),n()};return{loading:!1,form:{status:"",result_reason:""},rules:{status:[{validator:t,trigger:"blur"}],result_reason:[{required:!0,message:"如果审核不通过，原因必填",trigger:"blur"}]}}},created:function(){this.getProjectExamine(),this.getTypes()},methods:{getProjectExamine:function(){var e=f(o.a.mark(function e(){var t,r,n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,s["default"].getProjectExamine(this.editID);case 4:t=e.sent,t.status=1==t.status,this.form=t,e.next=25;break;case 9:if(e.prev=9,e.t0=e["catch"](1),!e.t0.data){e.next=24;break}if(r=e.t0.data.msg,!r||"object"!==u(r)){e.next=22;break}e.t1=o.a.keys(r);case 15:if((e.t2=e.t1()).done){e.next=22;break}return n=e.t2.value,this.$message.error(r[n]),e.next=20,setTimeout(function(){},1e3);case 20:e.next=15;break;case 22:e.next=25;break;case 24:this.$message.error(e.t0.toString());case 25:this.loading=!1;case 26:case"end":return e.stop()}},e,this,[[1,9]])}));function t(){return e.apply(this,arguments)}return t}(),submitform:function(e){var t=this;this.$refs[e].validate(function(){var e=f(o.a.mark(function e(r){var n,a,i;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=25;break}return t.loading=!0,e.prev=2,e.next=5,s["default"].editProjectExamine(t.editID,t.form);case 5:n=e.sent,0===n.error_code&&t.$message.success("".concat(n.msg)),t.back(),e.next=22;break;case 10:if(e.prev=10,e.t0=e["catch"](2),a=e.t0.data.msg,!a||"object"!==u(a)){e.next=22;break}e.t1=o.a.keys(a);case 15:if((e.t2=e.t1()).done){e.next=22;break}return i=e.t2.value,t.$message.error(a[i]),e.next=20,setTimeout(function(){},1e3);case 20:e.next=15;break;case 22:t.loading=!1,e.next=27;break;case 25:return t.$message.error("请填写正确的信息"),e.abrupt("return",!1);case 27:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}())},getTypes:function(){var e=f(o.a.mark(function e(){var t,r,n,a,i,s,u=this;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(n in t=[],r=this.fieldObj,r)t.push(n);return t=t.join(),e.next=6,c["default"].getTypeByField(t);case 6:if(a=e.sent,a&&0!=a.length){e.next=9;break}return e.abrupt("return");case 9:for(s in i=function(e){var t=r[e],n=a.find(function(t){return t["field"]==e});n&&(u[t]=n["value"])},r)i(s);case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),resetForm:function(e){this.$refs[e].resetFields()},back:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",e)}}},d=p,h=(r("6045"),r("2877")),m=Object(h["a"])(d,n,a,!1,null,"5cb6f045",null);t["default"]=m.exports},"5c7f":function(e,t,r){"use strict";r.r(t);var n=r("a34a"),a=r.n(n),i=r("dfd8"),o=r("f121");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){l(i,n,a,o,s,"next",e)}function s(e){l(i,n,a,o,s,"throw",e)}o(void 0)})}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}var m=function(){function e(){p(this,e)}return h(e,[{key:"getAllProjectExamine",value:function(){var e=f(a.a.mark(function e(){var t,r,n,s,u,l=arguments;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,r=l.length>1&&void 0!==l[1]?l[1]:{},n=l.length>2&&void 0!==l[2]?l[2]:o["default"].pageSize,s=c({page:t,count:n},r,{handleError:!0}),e.next=6,Object(i["get"])("v1/project_examine/all",s);case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getProjectExamines",value:function(){var e=f(a.a.mark(function e(){var t,r,n,s,u,l=arguments;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:0,r=l.length>1&&void 0!==l[1]?l[1]:{},n=l.length>2&&void 0!==l[2]?l[2]:o["default"].pageSize,s=c({page:t,count:n},r,{handleError:!0}),e.next=6,Object(i["get"])("v1/project_examine",s);case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getProjectExamine",value:function(){var e=f(a.a.mark(function e(t){var r;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["get"])("v1/project_examine/".concat(t),{handleError:!0});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"addProjectExamine",value:function(){var e=f(a.a.mark(function e(t){var r;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["post"])("v1/project_examine",t,{handleError:!0});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"editProjectExamine",value:function(){var e=f(a.a.mark(function e(t,r){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["put"])("v1/project_examine/".concat(t),r,{handleError:!0});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}();t["default"]=new m},"5f23":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["list"===e.redirectType?r("div",{staticClass:"container page-container"},[r("sticky-top",[r("div",{staticClass:"order-header"},[r("div",{staticClass:"header-left"},[r("p",{staticClass:"title"})]),r("div",{staticClass:"header-right"},[r("el-select",{attrs:{size:"medium",filterable:"","default-first-option":"",placeholder:"请选择跟进状态",prop:"curFollowStatus"},on:{change:e.statusChange},model:{value:e.curStatus,callback:function(t){e.curStatus=t},expression:"curStatus"}},[r("el-option",{attrs:{label:"全部审核状态",value:-1}}),e._l(e.statusData,function(e,t){return r("el-option",{key:t,attrs:{label:e,value:t}})})],2),r("el-button",{staticClass:"back-btn",attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.backInit}},[e._v("返回浏览")])],1)]),r("el-divider")],1),e._m(0),r("lin-table",{attrs:{tableColumn:e.tableColumn,tableData:e.tableData,operate:e.operate,loading:e.loading,curPage:e.currentPage,pagination:e.pagination},on:{currentChange:e.currentChange,handleEdit:e.handleEdit,handleLog:e.handleLog,handleDelete:e.handleDelete}})],1):"log"===e.redirectType?r("customer-log-list",{attrs:{projectID:e.projectID,customerID:e.customerID,linkCode:e.linkCode},on:{close:e.closePage}}):e._e(),r("el-dialog",{attrs:{title:"审核",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("project-examine-edit",{attrs:{projectID:e.projectID,editID:e.editID},on:{close:e.dialogClose}})],1)],1)},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header"},[r("div",{staticClass:"title"},[r("span",[e._v("客户项目审核列表")])])])}],i=r("a34a"),o=r.n(i),s=r("5c7f"),c=r("1a3a"),u=r("cd57"),l=r("4360"),f=r("93c2");function p(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){p(i,n,a,o,s,"next",e)}function s(e){p(i,n,a,o,s,"throw",e)}o(void 0)})}}var h={name:"CustomerProjectLists",components:{ProjectExamineEdit:c["default"],CustomerLogList:u["default"]},data:function(){return{curStatus:-1,currentPage:1,dialogFormVisible:!1,tableColumn:[{prop:"id",label:"id",width:100},{prop:"author",label:"申请人",width:100},{prop:"customer_name",label:"客户名",width:200},{prop:"project_name",label:"项目名",width:200},{prop:"reason",label:"原因",width:200},{prop:"status",label:"审核状态",type:"html",width:150},{prop:"result_reason",label:"驳回原因"},{prop:"create_time",label:"生成时间",width:200}],statusData:["审核不通过","审核通过","正在审核中"],pagination:{pageTotal:0},tableData:[],operate:[{name:"审核",func:"handleEdit",type:"primary",auth:"审核项目"},{name:"日志",func:"handleLog",type:"danger",icon:"",auth:"审核项目"}],statusObj:{0:'<span style="color: #c75d6e;">审核不通过</span>',1:'<span style="color: #3963bc;">审核通过</span>',2:'<span style="color: orange;">正在审核中</span>'},showEdit:!1,loading:!1,editID:1,projectID:0,customerID:0,linkCode:0,redirectType:"list"}},created:function(){this.getTypes(),this.getProjectExamines()},methods:{statusChange:function(e){this.curStatus=e,this.getProjectExamines()},backInit:function(){this.curStatus=-1,this.getProjectExamines()},getProjectExamines:function(){var e=d(o.a.mark(function e(){var t,r,n,a=this,i=arguments;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:0,this.loading=!0,r={},n={},-1!=this.curStatus&&(n["status"]=this.curStatus),"super"!=l["default"].state.user.username&&!l["default"].state.auths.includes("全部项目信息")){e.next=10;break}return e.next=7,s["default"].getAllProjectExamine(t,n);case 7:r=e.sent,e.next=13;break;case 10:return e.next=12,s["default"].getProjectExamines(t,n);case 12:r=e.sent;case 13:if(this.pagination.pageTotal&&this.pagination.pageTotal==r.total_nums||(this.pagination={pageTotal:r.total_nums}),!(r.total_nums<=0)){e.next=18;break}return this.tableData=[],this.loading=!1,e.abrupt("return");case 18:r.collection.forEach(function(e){e.status=a.statusObj[e.status]||"错误"}),this.loading=!1,this.tableData=r.collection;case 21:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),currentChange:function(e){e<=0||(e-=1,this.currentPage=e+1,this.getProjectExamines(e))},handleEdit:function(e){var t=e.row;this.editID=t.id,this.projectID=t.project_id,this.dialogFormVisible=!0},handleLog:function(e){var t=e.row;t.customer_id&&(this.customerID=t.customer_id),this.projectID=t.project_id,this.linkCode=t.link_code,this.editID=t.id,this.redirectType="log"},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d(o.a.mark(function r(){var n,a;return o.a.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return n=[e.row.id],t.loading=!0,r.next=4,Cultural.delCultural(n);case 4:a=r.sent,t.loading=!1,0===a.error_code&&(t.getCulturals(),t.$message({type:"success",message:"".concat(a.msg)}));case 7:case"end":return r.stop()}},r)})))},rowClick:function(){},closePage:function(e){this.redirectType="list",e&&this.getProjectExamines(this.currentPage-1)},getTypes:function(){var e=d(o.a.mark(function e(){var t,r,n,a,i,s,c=this;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(n in t=[],r=this.fieldObj,r)t.push(n);return t=t.join(),e.next=6,f["default"].getTypeByField(t);case 6:if(a=e.sent,a&&0!=a.length){e.next=9;break}return e.abrupt("return");case 9:for(s in i=function(e){var t=r[e],n=a.find(function(t){return t["field"]==e});n&&(c[t]=n["value"])},r)i(s);case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),dialogClose:function(){this.dialogFormVisible=!1,this.getProjectExamines(this.currentPage-1)}}},m=h,v=(r("1732"),r("2877")),g=Object(v["a"])(m,n,a,!1,null,"58f6c288",null);t["default"]=g.exports},6045:function(e,t,r){"use strict";r("0c77")},ee83:function(e,t,r){}}]);