(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e0eb0d2"],{"48fa":function(e,t,a){},6105:function(e,t,a){"use strict";a("48fa")},6393:function(e,t,a){},"78e1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["list"===e.redirectType?a("div",{staticClass:"container"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[a("span",[e._v("SPU列表")]),a("el-button",{staticClass:"add-banner-item",attrs:{type:"primary",plain:""},on:{click:e.handleAdd}},[e._v("添加SPU")])],1)]),a("lin-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{tableColumn:e.tableColumn,tableData:e.tableData,operate:e.operate,pagination:e.pagination,curPage:e.currentPage},on:{currentChange:e.currentChange,handleEdit:e.handleEdit,handleDelete:e.handleDelete,"row-click":e.rowClick}})],1):"add"===e.redirectType?a("spu-add",{on:{close:e.closePage}}):"edit"===e.redirectType?a("spu-edit",{attrs:{editID:e.editID},on:{close:e.closePage}}):e._e()],1)},i=[],s=a("a34a"),l=a.n(s),n=a("7954"),o=a("e529"),c=a("5e0d");function u(e,t,a,r,i,s,l){try{var n=e[s](l),o=n.value}catch(c){return void a(c)}n.done?t(o):Promise.resolve(o).then(r,i)}function p(e){return function(){var t=this,a=arguments;return new Promise(function(r,i){var s=e.apply(t,a);function l(e){u(s,r,i,l,n,"next",e)}function n(e){u(s,r,i,l,n,"throw",e)}l(void 0)})}}var m={name:"SpuList",components:{SpuAdd:o["default"],SpuEdit:c["default"]},data:function(){return{loading:!1,tableColumn:[{prop:"id",label:"id",width:100},{prop:"img",label:"图片",type:"image",width:150},{prop:"title",label:"标题",width:350},{prop:"subtitle",label:"副标题",width:300},{prop:"category",label:"分类名",width:150},{prop:"price",label:"价格(元)",width:150},{prop:"online",label:"是否上架",width:150}],tableData:[],operate:[],pagination:{pageTotal:0},showEdit:!1,editID:1,redirectType:"list",currentPage:1}},created:function(){this.operate=[{name:"编辑",func:"handleEdit",type:"primary"},{name:"删除",func:"handleDelete",type:"danger",auth:"删除图书"}],this.getSpus()},methods:{getSpus:function(){var e=p(l.a.mark(function e(){var t,a,r=arguments;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:0,this.loading=!0,e.next=4,n["default"].getSpus(t);case 4:if(a=e.sent,this.loading=!1,!(a.total_nums<=0)){e.next=9;break}return this.tableData=[],e.abrupt("return");case 9:this.pagination.pageTotal||(this.pagination={pageTotal:a.total_nums}),a.collection.forEach(function(e){var t=e.category;e["category"]=t?t["name"]:"暂无",e["online"]=0===e["online"]?"否":"是"}),this.tableData=a.collection;case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),currentChange:function(e){e<=0||(e-=1,this.currentPage=e+1,this.getSpus(e))},handleAdd:function(){this.redirectType="add"},handleEdit:function(e){var t=e.row;this.editID=t.id,this.redirectType="edit"},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该图书, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(p(l.a.mark(function a(){var r,i;return l.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=[e.row.id],t.loading=!0,a.next=4,n["default"].delSpu(r);case 4:i=a.sent,t.loading=!1,0===i.error_code&&(t.getSpus(t.currentPage-1),t.$message({type:"success",message:"".concat(i.msg)}));case 7:case"end":return a.stop()}},a)})))},rowClick:function(){},closePage:function(e){this.redirectType="list",console.log(this.currentPage),e&&this.getSpus(this.currentPage-1)}}},d=m,f=(a("6105"),a("cba8")),h=Object(f["a"])(d,r,i,!1,null,"7c67d3b7",null);t["default"]=h.exports},"7e13":function(e,t,a){"use strict";a("6393")},e529:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[e._v("新建SPU "),a("span",{staticClass:"back",on:{click:function(t){return e.back(!1)}}},[a("i",{staticClass:"iconfont icon-fanhui"}),e._v(" 返回 ")])]),a("div",{staticClass:"wrap"},[a("el-row",[a("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"subtitle"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写副标题"},model:{value:e.form.subtitle,callback:function(t){e.$set(e.form,"subtitle",t)},expression:"form.subtitle"}})],1),a("el-form-item",{attrs:{label:"文创标题",prop:"extratitle"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写文创标题"},model:{value:e.form.extratitle,callback:function(t){e.$set(e.form,"extratitle",t)},expression:"form.extratitle"}})],1),a("el-form-item",{attrs:{label:"文创描述",prop:"extradesc"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写文创描述"},model:{value:e.form.extradesc,callback:function(t){e.$set(e.form,"extradesc",t)},expression:"form.extradesc"}})],1),a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写价格"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),a("el-form-item",{attrs:{label:"折扣",prop:"discount_price"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写折扣"},model:{value:e.form.discount_price,callback:function(t){e.$set(e.form,"discount_price",t)},expression:"form.discount_price"}})],1),a("el-form-item",{attrs:{label:"淘宝口令",prop:"tb_command"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写淘宝口令"},model:{value:e.form.tb_command,callback:function(t){e.$set(e.form,"tb_command",t)},expression:"form.tb_command"}})],1),a("el-form-item",{attrs:{label:"分类",prop:"category_id"}},[a("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择分类"},model:{value:e.form.category_id,callback:function(t){e.$set(e.form,"category_id",t)},expression:"form.category_id"}},[a("el-option",{attrs:{value:0,label:"请选择分类"}},[a("span",[e._v("请选择分类")])]),e._l(e.cateData,function(t){return[a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}},[a("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[e._v(e._s(t.id))]),a("span",[e._v(e._s(t.name))])]),e._l(t.sub,function(r){return t.sub?[a("el-option",{key:r.id,attrs:{value:r.id,label:r.name}},[a("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[e._v("┞----"+e._s(r.id))]),a("span",[e._v(e._s(r.name))])])]:e._e()})]})],2)],1),a("el-form-item",{attrs:{label:"默认sku",prop:"default_sku_id"}},[a("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择默认sku"},model:{value:e.form.default_sku_id,callback:function(t){e.$set(e.form,"default_sku_id",t)},expression:"form.default_sku_id"}},[a("el-option",{attrs:{value:0,label:"请选择分类"}},[a("span",[e._v("请选择分类")])]),e._l(e.skuData,function(t){return[a("el-option",{attrs:{value:t.id,label:t.title}},[a("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[e._v(e._s(t.id))]),a("span",[e._v(e._s(t.title))])])]})],2)],1),a("el-form-item",{attrs:{label:"是否上架",prop:"online"}},[a("el-switch",{attrs:{"active-color":"#3963bc"},model:{value:e.form.online,callback:function(t){e.$set(e.form,"online",t)},expression:"form.online"}})],1),a("el-form-item",{attrs:{label:"主图",prop:"img"}},[a("upload-imgs",{ref:"uploadEleMain",attrs:{rules:e.imgRules,maxNum:1}})],1),a("el-form-item",{attrs:{label:"主题图",prop:"for_theme_img"}},[a("upload-imgs",{ref:"uploadEleTheme",attrs:{rules:e.imgRules,maxNum:1}})],1),a("el-form-item",{attrs:{label:"轮播图",prop:"spu_img_list"}},[a("upload-imgs",{ref:"uploadEleImg",attrs:{rules:e.imgRules,sortable:!0}})],1),a("el-form-item",{attrs:{label:"详情图",prop:"spu_detail_img_list"}},[a("upload-imgs",{ref:"uploadEleImgList",attrs:{rules:e.imgRules,sortable:!0}})],1),a("el-form-item",{attrs:{label:"规格图",prop:"spec_img"}},[a("upload-imgs",{ref:"uploadEleSpec",attrs:{rules:e.imgRules,maxNum:2}})],1),a("el-form-item",{attrs:{label:"注意事项",prop:"notice_img"}},[a("upload-imgs",{ref:"uploadEleNotice",attrs:{rules:e.imgRules,maxNum:2}})],1),a("el-form-item",{attrs:{label:"标签",prop:"tags"}},[a("tag",{on:{handleConfirm:e.handleTagConfirm}})],1),a("el-form-item",{staticClass:"multiple-select",attrs:{label:"选择规格",prop:"specs"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择规格"},on:{change:e.specChange},model:{value:e.form.specs,callback:function(t){e.$set(e.form,"specs",t)},expression:"form.specs"}},e._l(e.specData,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"可视规格",prop:"sketch_spec_id"}},[a("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择可视规格"},on:{"visible-change":e.visibleChange},model:{value:e.form.sketch_spec_id,callback:function(t){e.$set(e.form,"sketch_spec_id",t)},expression:"form.sketch_spec_id"}},e._l(e.selSepcData,function(e){return a("el-option",{key:e.value,attrs:{value:e.spec_id,label:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"是否测试",prop:"is_test"}},[a("el-switch",{attrs:{"active-color":"#3963bc"},model:{value:e.form.is_test,callback:function(t){e.$set(e.form,"is_test",t)},expression:"form.is_test"}})],1),a("el-form-item",{attrs:{label:"是否参加活动",prop:"is_active"}},[a("el-switch",{attrs:{"active-color":"#3963bc"},model:{value:e.form.is_active,callback:function(t){e.$set(e.form,"is_active",t)},expression:"form.is_active"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"扩展字段",prop:"extend_field"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写分享位置索引"},model:{value:e.form.extend_field,callback:function(t){e.$set(e.form,"extend_field",t)},expression:"form.extend_field"}})],1),a("el-form-item",{attrs:{label:"已售数量",prop:"sale_num"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写已售数量"},model:{value:e.form.sale_num,callback:function(t){e.$set(e.form,"sale_num",t)},expression:"form.sale_num"}})],1),a("el-form-item",{attrs:{label:"总数量",prop:"total_num"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写总数量"},model:{value:e.form.total_num,callback:function(t){e.$set(e.form,"total_num",t)},expression:"form.total_num"}})],1),a("el-form-item",{staticClass:"submit"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("保 存")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重 置")])],1)],1)],1)],1)],1)])},i=[],s=a("a34a"),l=a.n(s),n=a("c1bd"),o=a("7954"),c=a("87e7"),u=a("5725"),p=a("306b"),m=a("e0ba"),d=a("f941");function f(e){return f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(e,t,a,r,i,s,l){try{var n=e[s](l),o=n.value}catch(c){return void a(c)}n.done?t(o):Promise.resolve(o).then(r,i)}function g(e){return function(){var t=this,a=arguments;return new Promise(function(r,i){var s=e.apply(t,a);function l(e){h(s,r,i,l,n,"next",e)}function n(e){h(s,r,i,l,n,"throw",e)}l(void 0)})}}var v={name:"SpuAdd",components:{UploadImgs:m["default"],tag:d["default"]},data:function(){return{loading:!1,cateData:{},skuData:[],specData:[],selSepcData:[],form:{title:"",name:"",description:"",online:!0,is_active:!1,specs:[],spu_detail_img_list:[],spu_img_list:[],for_theme_img:"",sketch_spec_id:"",img:"",tags:[]},imgRules:{minWidth:100,minHeight:100,maxSize:5},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],tpl_name:[{required:!0,message:"请输入模板名",trigger:"blur"}]}}},created:function(){this._initialize()},methods:{_initialize:function(){this.getSkus(),this.getTreeCate(),this.getSpecs()},getSkus:function(){var e=g(l.a.mark(function e(){var t;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["default"].getSkus(0,80);case 2:t=e.sent,this.skuData=t["collection"];case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getTreeCate:function(){var e=g(l.a.mark(function e(){var t,a,r=arguments;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:0,a=r.length>1&&void 0!==r[1]?r[1]:2,e.prev=2,e.next=5,n["default"].getTreeCate(t,a);case 5:this.cateData=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),this.cateData={};case 11:case"end":return e.stop()}},e,this,[[2,8]])}));function t(){return e.apply(this,arguments)}return t}(),getSpecs:function(){var e=g(l.a.mark(function e(){var t;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["default"].getSpecs(0,20);case 3:t=e.sent,this.specData=t.collection,this.solveSpecs(this.specData),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.specData=[];case 11:case"end":return e.stop()}},e,this,[[0,8]])}));function t(){return e.apply(this,arguments)}return t}(),visibleChange:function(e){e&&0===this.selSepcData.length&&this.$message.error("请先选择规格")},specChange:function(e){var t=this,a=e.map(function(e){if(t.solveSpec[e])return t.solveSpec[e]});this.selSepcData=a,this.observerSketchSpecId(a)},observerSketchSpecId:function(e){var t=this.form.sketch_spec_id;t||(this.form.sketch_spec_id="");var a=e.some(function(e){return e.spec_id===t});a||this.$set(this.form,"sketch_spec_id","")},solveSpecs:function(e){if(Array.isArray(e)&&0!==e.length){var t={};e.forEach(function(e){var a=e["id"]||e["spec_id"];t[a]={spec_id:a,value:e["name"]||e["value"]}}),this.solveSpec=t}},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var a=g(l.a.mark(function a(r){var i,s,n;return l.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=28;break}return t.loading=!0,a.prev=2,a.next=5,t.solveAllImgs();case 5:return t.form["specs"]=t.selSepcData,t.form["tags"]=t.form["tags"].join("$"),a.next=9,o["default"].addSpu(t.form);case 9:i=a.sent,0===i.error_code&&(t.$message.success("".concat(i.msg)),t.resetForm(e),t.back()),a.next=25;break;case 13:if(a.prev=13,a.t0=a["catch"](2),s=a.t0.data.msg,!s||"object"!==f(s)){a.next=25;break}a.t1=l.a.keys(s);case 18:if((a.t2=a.t1()).done){a.next=25;break}return n=a.t2.value,t.$message.error(s[n]),a.next=23,setTimeout(function(){},1e3);case 23:a.next=18;break;case 25:t.loading=!1,a.next=30;break;case 28:return t.$message.error("请填写正确的信息"),a.abrupt("return",!1);case 30:case"end":return a.stop()}},a,null,[[2,13]])}));return function(e){return a.apply(this,arguments)}}())},solveAllImgs:function(){var e=g(l.a.mark(function e(){var t,a,r,i,s,n;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.uploadEleMain.getValue();case 2:return t=e.sent,e.next=5,this.$refs.uploadEleTheme.getValue();case 5:return a=e.sent,e.next=8,this.$refs.uploadEleImg.getValue();case 8:return r=e.sent,e.next=11,this.$refs.uploadEleImgList.getValue();case 11:return i=e.sent,e.next=14,this.$refs.uploadEleSpec.getValue();case 14:return s=e.sent,e.next=17,this.$refs.uploadEleNotice.getValue();case 17:n=e.sent,this.form["img"]=p["default"].solveUploadImg(t),this.form["for_theme_img"]=p["default"].solveUploadImg(a),this.form["spu_img_list"]=p["default"].solveUploadMultipleImg(r),this.form["spu_detail_img_list"]=p["default"].solveUploadMultipleImg(i),this.form["spec_img"]=p["default"].solveUploadMultipleImg(s),this.form["notice_img"]=p["default"].solveUploadMultipleImg(n);case 24:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleTagConfirm:function(e){this.form.tags=e},resetForm:function(e){this.$refs[e].resetFields()},back:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",e)}}},b=v,_=(a("7e13"),a("cba8")),x=Object(_["a"])(b,r,i,!1,null,"23a14c2c",null);t["default"]=x.exports}}]);