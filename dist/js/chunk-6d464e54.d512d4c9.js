(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d464e54","chunk-414ab668"],{"3e43":function(e,t,a){},"50ed":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[a("span",[e._v("添加宫格")]),a("span",{staticClass:"back",on:{click:function(t){return e.back(!1)}}},[a("i",{staticClass:"iconfont icon-fanhui"}),e._v(" 返回 ")])]),a("div",{staticClass:"wrap"},[a("el-row",[a("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"宫格标题",prop:"title"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写宫格标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"宫格名",prop:"name"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写宫格名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"分类",prop:"parent_id"}},[a("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择分类"},model:{value:e.form.parent_id,callback:function(t){e.$set(e.form,"parent_id",t)},expression:"form.parent_id"}},[e._l(e.cateData,function(t){return[a("el-option",{attrs:{value:t.id,label:t.name}},[a("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[e._v(e._s(t.id))]),a("span",[e._v(e._s(t.name))])]),e._l(t.sub,function(n){return t.sub?[a("el-option",{attrs:{value:n.id,label:n.name}},[a("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[e._v("┞----"+e._s(n.id))]),a("span",[e._v(e._s(n.name))])]),e._l(n.sub,function(t){return n.sub?[a("el-option",{attrs:{value:t.id,label:t.name}},[a("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[e._v("┞------"+e._s(t.id))]),a("span",[e._v(e._s(t.name))])])]:e._e()})]:e._e()})]})],2)],1),a("el-form-item",{attrs:{label:"排序",prop:"order"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写宫格排序"},model:{value:e.form.order,callback:function(t){e.$set(e.form,"order",t)},expression:"form.order"}})],1),a("el-form-item",{attrs:{label:"显示上线",prop:"show"}},[a("el-switch",{attrs:{"active-color":"#3963bc"},model:{value:e.form.show,callback:function(t){e.$set(e.form,"show",t)},expression:"form.show"}})],1),a("el-form-item",{attrs:{label:"图片",prop:"img"}},[a("upload-imgs",{ref:"uploadEle",attrs:{rules:e.imgRules,maxNum:1}})],1),a("el-form-item",{attrs:{label:"宫格描述",prop:"description"}},[a("el-input",{attrs:{size:"medium",placeholder:"请填写宫格描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{staticClass:"submit"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("保 存")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重 置")])],1)],1)],1)],1)],1)])},i=[],r=a("a34a"),o=a.n(r),l=a("51ba"),s=a("c1bd"),c=a("306b"),u=a("e0ba");function d(e){return d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e,t,a,n,i,r,o){try{var l=e[r](o),s=l.value}catch(c){return void a(c)}l.done?t(s):Promise.resolve(s).then(n,i)}function f(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var r=e.apply(t,a);function o(e){p(r,n,i,o,l,"next",e)}function l(e){p(r,n,i,o,l,"throw",e)}o(void 0)})}}var h={props:{pid:Number},components:{UploadImgs:u["default"]},data:function(){return{loading:!1,cateData:{},form:{name:"",order:50,show:!0,description:""},imgRules:{minWidth:0,minHeight:0,maxSize:5},rules:{title:[{required:!0,message:"请输入宫格标题",trigger:"blur"}]}}},created:function(){this.getTreeCate()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var a=f(o.a.mark(function a(n){var i,r,s,u;return o.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(!n){a.next=28;break}return a.prev=1,a.next=4,t.$refs.uploadEle.getValue();case 4:return i=a.sent,t.form.img=c["default"].solveUploadImg(i),t.loading=!0,a.next=9,l["default"].addGrid(t.form);case 9:r=a.sent,t.loading=!1,0===r.error_code&&(t.$message.success("".concat(r.msg)),t.resetForm(e),t.back()),a.next=26;break;case 14:if(a.prev=14,a.t0=a["catch"](1),s=a.t0.data.msg,!s||"object"!==d(s)){a.next=26;break}a.t1=o.a.keys(s);case 19:if((a.t2=a.t1()).done){a.next=26;break}return u=a.t2.value,t.$message.error(s[u]),a.next=24,setTimeout(function(){},1e3);case 24:a.next=19;break;case 26:a.next=30;break;case 28:return t.$message.error("请填写正确的信息"),a.abrupt("return",!1);case 30:case"end":return a.stop()}},a,null,[[1,14]])}));return function(e){return a.apply(this,arguments)}}())},getTreeCate:function(){var e=f(o.a.mark(function e(){var t,a,n=arguments;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:0,a=n.length>1&&void 0!==n[1]?n[1]:2,e.prev=2,e.next=5,s["default"].getTreeCate(t,a);case 5:this.cateData=e.sent,console.log(this.cateData),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),this.cateData={};case 12:case"end":return e.stop()}},e,this,[[2,9]])}));function t(){return e.apply(this,arguments)}return t}(),resetForm:function(e){this.$refs[e].resetFields()},back:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",e)}}},m=h,b=(a("ca9c"),a("cba8")),g=Object(b["a"])(m,n,i,!1,null,"2d02ec3e",null);t["default"]=g.exports},"5e18":function(e,t,a){},"751c":function(e,t,a){"use strict";a("c1cd")},"844d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["list"===e.redirectType?a("div",{staticClass:"container"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[a("span",[e._v("宫格列表")]),a("el-button",{staticClass:"add-banner-item",attrs:{type:"primary",plain:""},on:{click:e.handleAdd}},[e._v("添加宫格")])],1)]),a("feiy-table",{attrs:{tableColumn:e.tableColumn,tableData:e.tableData,operate:e.operate,loading:e.loading},on:{handleEdit:e.handleEdit,handleDelete:e.handleDelete,handleCellSave:e.handleCellSave,handleRecommend:e.handleRecommend}})],1):"edit"===e.redirectType?a("grid-category-edit",{attrs:{editID:e.editID},on:{close:e.closePage}}):"add"===e.redirectType?a("grid-category-add",{on:{close:e.closePage}}):e._e()],1)},i=[],r=a("a34a"),o=a.n(r),l=a("51ba"),s=a("50ed"),c=a("1e75"),u=a("f73d");function d(e,t,a,n,i,r,o){try{var l=e[r](o),s=l.value}catch(c){return void a(c)}l.done?t(s):Promise.resolve(s).then(n,i)}function p(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var r=e.apply(t,a);function o(e){d(r,n,i,o,l,"next",e)}function l(e){d(r,n,i,o,l,"throw",e)}o(void 0)})}}var f={name:"CategoryList",components:{GridCategoryAdd:s["default"],GridCategoryEdit:c["default"],feiyTable:u["default"]},data:function(){return{tableColumn:[{prop:"id",label:"id",width:150},{prop:"img",label:"图片",type:"image",width:200,noRepeat:!0},{prop:"name",label:"名称",width:200},{prop:"order",label:"排序",type:"edit",order:1,width:200,edit:!1,noRepeat:!0},{prop:"show",label:"状态",type:"radio",width:200,noRepeat:!0},{prop:"description",label:"描述"}],tableData:[],operate:[],editRow:0,redirectType:"list",editID:1,loading:!1}},created:function(){this.operate=[{name:"编辑",func:"handleEdit",type:"primary"},{name:"删除",func:"handleDelete",type:"danger",auth:"删除宫格"}],this.getCates()},methods:{handleCellSave:function(){var e=p(o.a.mark(function e(t){var a,n,i,r;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.row,n=t.prop,i=this.singleUpdate({id:a.id,value:a[n],type:1,field:n}),this.loading=!0,e.next=5,l["default"].updateSingle(i);case 5:r=e.sent,this.loading=!1,0===r.error_code&&(this.$message.success("".concat(r.msg)),this.getCates());case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getCates:function(){var e=p(o.a.mark(function e(){var t;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,l["default"].getGrids();case 4:t=e.sent,t.forEach(function(e){e.show=!!e.show}),this.tableData=t,this.loading=!1,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),this.loading=!1,81006===e.t0.error_code&&(this.tableData=[]);case 14:case"end":return e.stop()}},e,this,[[0,10]])}));function t(){return e.apply(this,arguments)}return t}(),handleRecommend:function(){var e=p(o.a.mark(function e(t){var a,n,i,r;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.val,n=t.row,this.loading=!0,a=a?1:0,i=this.singleUpdate({id:n.id,value:a,type:1}),e.next=6,l["default"].updateSingle(i);case 6:r=e.sent,this.loading=!1,0===r.error_code&&this.$message.success("".concat(r.msg));case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),singleUpdate:function(e){var t=e.id,a=e.value,n=e.field,i=e.type,r={};return r.id=t,r.value=a,n&&(r.field=n),i&&(r.type=1),r},handleAdd:function(){this.redirectType="add"},handleSonCate:function(e){e.index;var t=e.row;this.$router.push({path:"/sub_category/".concat(t.id,"/list")})},handleEdit:function(e){e.index;var t=e.row;this.redirectType="edit",this.editID=t.id},handleDelete:function(e){var t=this,a=(e.index,e.row);this.$confirm("此操作将永久删除该宫格, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(p(o.a.mark(function e(){var n,i;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,n=[a.id],e.next=4,category.delCate(n);case 4:i=e.sent,t.loading=!1,0===i.error_code&&(t.getCates(),t.$message({type:"success",message:"".concat(i.msg)}));case 7:case"end":return e.stop()}},e)})))},closePage:function(e){this.redirectType="list",e&&this.getCates()}},watch:{editRow:function(){return this.filterTableColumn[3]&&0===this.editRow&&this.$set(this.filterTableColumn[3],"width",180),""}}},h=f,m=(a("ba7b"),a("cba8")),b=Object(m["a"])(h,n,i,!1,null,"6ef8013c",null);t["default"]=b.exports},ba7b:function(e,t,a){"use strict";a("5e18")},c1cd:function(e,t,a){},ca9c:function(e,t,a){"use strict";a("3e43")},f73d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feiy-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"el-table-wrap",attrs:{data:e.tableData,id:"out-table'"},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},[e._l(e.filterTableColumn,function(t){return[t.noRepeat?e._e():a("el-table-column",{key:t.label,attrs:{prop:t.prop,label:t.label,"show-overflow-tooltip":!0,fixed:!!t.fixed&&t.fixed,width:t.width?t.width:""}}),"image"===t.type?a("el-table-column",{key:t.label,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row[t.prop]?a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:n.row[t.prop],fit:"cover"}}):a("span",[e._v("暂无图片")])]}}],null,!0)}):e._e(),"tag"===t.type?a("el-table-column",{key:t.label,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t("default",null,{tag:a.row[t.prop],prop:t.prop})]}}],null,!0)}):e._e(),"edit"===t.type?a("el-table-column",{key:t.label,attrs:{label:t.label,prop:t.prop,width:t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.editFlag?a("div",{staticClass:"table-edit"},[a("el-input",{attrs:{size:"mini"},model:{value:n.row[t.prop],callback:function(a){e.$set(n.row,t.prop,a)},expression:"scope.row[item.prop]"}}),a("div",{staticClass:"cell-icon-edit"},[a("div",{staticClass:"cell-save",on:{click:function(a){return e.handleCellSave(n.row,n.$index,t.prop)}}},[a("i",{staticClass:"el-icon-check"})]),a("div",{staticClass:"cell-cancel",on:{click:function(a){return e.handleCellCancel(n.row,n.$index,t.prop)}}},[a("i",{staticClass:"el-icon-close"})])])],1):a("div",{staticClass:"table-edit table-edit-start"},[a("div",{staticClass:"content"},[e._v(e._s(n.row[t.prop]))]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showEdit[n.row.id],expression:"showEdit[scope.row.id]"}],staticClass:"cell-icon",on:{click:function(a){return e.handleCellEdit(n.row,n.$index,t.prop)}}},[a("i",{staticClass:"el-icon-edit"})])])]}}],null,!0)}):e._e(),"radio"===t.type?a("el-table-column",{key:t.label,attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(n){return[a("el-switch",{attrs:{"active-color":"#3963bc"},on:{change:function(t){return e.handleRecommend(t,n.row)}},model:{value:n.row[t.prop],callback:function(a){e.$set(n.row,t.prop,a)},expression:"scope.row[item.prop]"}})]}}],null,!0)}):e._e(),"rate"===t.type?a("el-table-column",{attrs:{label:t.label,prop:t.prop,width:t.width},scopedSlots:e._u([{key:"default",fn:function(n){return[a("el-rate",{attrs:{colors:t.color,disabled:t.disabled,max:t.max},on:{change:function(a){return e.rateChange(t.prop,n.row)}},model:{value:n.row[t.prop],callback:function(a){e.$set(n.row,t.prop,a)},expression:"scope.row[item.prop]"}}),t.reset?a("div",{staticClass:"reset-rate",staticStyle:{"font-size":"12px","margin-left":"10px",cursor:"pointer"},on:{click:function(a){return e.resetRate(t.prop,n.row)}}},[e._v("重置")]):e._e()]}}],null,!0)}):e._e()]}),e.operate.length>0?a("el-table-column",{attrs:{label:"操作",fixed:"right",width:e.operateStyle.width},scopedSlots:e._u([{key:"default",fn:function(t){return e.operate.icon?e._l(e.operate,function(n,i){return a("el-button",{key:i,attrs:{type:n.type,plain:"",size:"mini"},nativeOn:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.buttonMethods(n.func,t.$index,t.row)}}},[e._v(e._s(n.name))])}):void 0}}],null,!0)}):e._e()],2),e.pagination?a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":e.pagination.pageSize?e.pagination.pageSize:10,total:e.pagination.pageTotal?e.pagination.pageTotal:null},on:{"current-change":e.currentChange}}):e._e()],1)},i=[],r={name:"feiy-table",props:{tableColumn:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},operate:{type:Array,default:function(){return[]}},operateStyle:{type:Object,default:function(){return{width:250}}},customColumn:{type:Array,default:function(){return[]}},pagination:{type:[Object,Boolean],default:!1},loading:{type:Boolean,default:!1}},data:function(){return{filterTableColumn:[],currentPage:1,currentData:[],selectedTableData:[],showEdit:{},cellIndex:-1,tempEditVal:{}}},created:function(){},watch:{customColumn:{handler:function(e){e.length>1&&(this.filterTableColumn=this.tableColumn.filter(function(t){return e.indexOf(t.label)>-1}))},deep:!0},tableData:{handler:function(){var e=this;this.initMouseEvent(),this.pagination&&this.pagination.pageSize?this.currentData=this.tableData.filter(function(t,a){return a<e.pagination.pageSize}):this.currentData=this.tableData},deep:!0,immediate:!0},tableColumn:{handler:function(e){var t=this;this.customColumn.length>1?this.filterTableColumn=this.tableColumn.filter(function(e){return t.customColumn.indexOf(e.label)>-1}):this.filterTableColumn=this.tableColumn},deep:!0,immediate:!0}},methods:{buttonMethods:function(e,t,a){var n=this,i=this.$options.methods;console.log(i),i[e](n,t,a)},handleEdit:function(e,t,a){e.$emit("handleEdit",{index:t,row:a})},handleDetail:function(e,t,a){e.$emit("handleDetail",{index:t,row:a})},handleStorage:function(e,t,a){e.$emit("handleStorage",{index:t,row:a})},resetRate:function(e,t){t[e]=0,this.rateChange(e,t)},rateChange:function(e,t){var a=t[e],n=t["id"];this.$emit("handleRate",{val:a,id:n})},handleDelete:function(e,t,a){e.$emit("handleDelete",{index:t,row:a})},handleSonCate:function(e,t,a){e.$emit("handleSonCate",{index:t,row:a})},handleCellEdit:function(e,t,a){e.editFlag=!0,this.cellIndex=t,this.tempEditVal[a]=e[a]},handleCellCancel:function(e,t,a){e.editFlag=!1,e[a]=this.tempEditVal[a]},handleCellSave:function(e,t,a){e.editFlag=!1,this.tempEditVal[a]=e[a],this.$emit("handleCellSave",{row:e,prop:a})},handleRecommend:function(e,t){this.$emit("handleRecommend",{val:e,row:t})},cellMouseEnter:function(e){this.showEdit[e.id]||this.$set(this.showEdit,e.id,!0)},cellMouseLeave:function(e){this.showEdit[e.id]&&this.$set(this.showEdit,e.id,!1)},initMouseEvent:function(){for(var e in this.showEdit)this.showEdit[e]&&this.$set(this.showEdit,e,!1)},currentChange:function(e){var t=this,a=[];this.oldVal=[],this.currentPage=e,this.selectedTableData=JSON.parse(sessionStorage.getItem("selectedTableData")),this.currentData=this.tableData.filter(function(e,a){return a>=(t.currentPage-1)*t.pagination.pageSize&&a<t.currentPage*t.pagination.pageSize}),this.$emit("currentChange",e),this.selectedTableData.forEach(function(e){for(var n=0;n<t.currentData.length;n++)t.currentData[n].key===e.key&&(t.oldVal.push(t.currentData[n]),a.push(t.currentData[n]))}),this.$nextTick(function(){t.toggleSelection instanceof Function&&t.toggleSelection(a)}),this.currentIndex=(this.currentPage-1)*this.pagination.pageSize+1}}},o=r,l=(a("751c"),a("cba8")),s=Object(l["a"])(o,n,i,!1,null,"046744fe",null);t["default"]=s.exports}}]);