(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70bc35f3","chunk-2d0d3353"],{"0c77":function(e,t,n){},"1a3a":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"wrap"},[n("el-row",[n("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"120px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"丢单原因"}},[n("el-input",{attrs:{size:"medium",disabled:"",placeholder:"请填写丢单原因"},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1),n("el-form-item",{attrs:{label:"审核状态",prop:"status"}},[n("el-switch",{attrs:{"active-text":"通过","inactive-text":"不通过","active-color":"#3963bc"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1),0==e.form.status||2==e.form.status?n("el-form-item",{attrs:{label:"驳回原因",prop:"result_reason"}},[n("el-input",{attrs:{type:"textarea",size:"medium",placeholder:"请填写驳回原因"},model:{value:e.form.result_reason,callback:function(t){e.$set(e.form,"result_reason",t)},expression:"form.result_reason"}})],1):e._e(),e.onlyRead?e._e():n("el-form-item",{staticClass:"submit"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitform("form")}}},[e._v("保 存")]),n("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重 置")])],1)],1)],1)],1)],1)])},a=[],i=n("a34a"),o=n.n(i),s=n("5c7f"),c=n("93c2");function u(e){return u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){l(i,r,a,o,s,"next",e)}function s(e){l(i,r,a,o,s,"throw",e)}o(void 0)})}}var p={name:"ProjectExamineAdd",props:{projectID:Number,editID:Number,onlyRead:{type:Boolean,default:!1}},watch:{},data:function(){var e=this,t=function(t,n,r){n||e.$refs.form.validateField("result_reason"),r()};return{loading:!1,form:{status:"",result_reason:""},rules:{status:[{validator:t,trigger:"blur"}],result_reason:[{required:!0,message:"如果审核不通过，原因必填",trigger:"blur"}]}}},created:function(){this.getProjectExamine(),this.getTypes()},methods:{getProjectExamine:function(){var e=f(o.a.mark(function e(){var t,n,r;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,s["default"].getProjectExamine(this.editID);case 4:t=e.sent,t.status=1==t.status,this.form=t,e.next=25;break;case 9:if(e.prev=9,e.t0=e["catch"](1),!e.t0.data){e.next=24;break}if(n=e.t0.data.msg,!n||"object"!==u(n)){e.next=22;break}e.t1=o.a.keys(n);case 15:if((e.t2=e.t1()).done){e.next=22;break}return r=e.t2.value,this.$message.error(n[r]),e.next=20,setTimeout(function(){},1e3);case 20:e.next=15;break;case 22:e.next=25;break;case 24:this.$message.error(e.t0.toString());case 25:this.loading=!1;case 26:case"end":return e.stop()}},e,this,[[1,9]])}));function t(){return e.apply(this,arguments)}return t}(),submitform:function(e){var t=this;this.$refs[e].validate(function(){var e=f(o.a.mark(function e(n){var r,a,i;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=25;break}return t.loading=!0,e.prev=2,e.next=5,s["default"].editProjectExamine(t.editID,t.form);case 5:r=e.sent,0===r.error_code&&t.$message.success("".concat(r.msg)),t.back(),e.next=22;break;case 10:if(e.prev=10,e.t0=e["catch"](2),a=e.t0.data.msg,!a||"object"!==u(a)){e.next=22;break}e.t1=o.a.keys(a);case 15:if((e.t2=e.t1()).done){e.next=22;break}return i=e.t2.value,t.$message.error(a[i]),e.next=20,setTimeout(function(){},1e3);case 20:e.next=15;break;case 22:t.loading=!1,e.next=27;break;case 25:return t.$message.error("请填写正确的信息"),e.abrupt("return",!1);case 27:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}())},getTypes:function(){var e=f(o.a.mark(function e(){var t,n,r,a,i,s,u=this;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(r in t=[],n=this.fieldObj,n)t.push(r);return t=t.join(),e.next=6,c["default"].getTypeByField(t);case 6:if(a=e.sent,a&&0!=a.length){e.next=9;break}return e.abrupt("return");case 9:for(s in i=function(e){var t=n[e],r=a.find(function(t){return t["field"]==e});r&&(u[t]=r["value"])},n)i(s);case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),resetForm:function(e){this.$refs[e].resetFields()},back:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",e)}}},d=p,h=(n("6045"),n("2877")),m=Object(h["a"])(d,r,a,!1,null,"5cb6f045",null);t["default"]=m.exports},"5b93":function(e,t,n){"use strict";n("8542")},"5c7f":function(e,t,n){"use strict";n.r(t);var r=n("a34a"),a=n.n(r),i=n("dfd8"),o=n("f121");function s(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,c,"next",e)}function c(e){s(i,r,a,o,c,"throw",e)}o(void 0)})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var p=function(){function e(){u(this,e)}return f(e,[{key:"getAllProjectExamine",value:function(){var e=c(a.a.mark(function e(){var t,n,r,s,c=arguments;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,n=c.length>1&&void 0!==c[1]?c[1]:o["default"].pageSize,r={page:t,count:n,handleError:!0},e.next=5,Object(i["get"])("v1/project_examine/all",r);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getProjectExamines",value:function(){var e=c(a.a.mark(function e(){var t,n,r,s,c=arguments;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,n=c.length>1&&void 0!==c[1]?c[1]:o["default"].pageSize,r={page:t,count:n,handleError:!0},e.next=5,Object(i["get"])("v1/project_examine",r);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getProjectExamine",value:function(){var e=c(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["get"])("v1/project_examine/".concat(t),{handleError:!0});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"addProjectExamine",value:function(){var e=c(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["post"])("v1/project_examine",t,{handleError:!0});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"editProjectExamine",value:function(){var e=c(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["put"])("v1/project_examine/".concat(t),n,{handleError:!0});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()}]),e}();t["default"]=new p},"5f23":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["list"===e.redirectType?n("div",{staticClass:"container page-container"},[e._m(0),n("lin-table",{attrs:{tableColumn:e.tableColumn,tableData:e.tableData,operate:e.operate,loading:e.loading,curPage:e.currentPage,pagination:e.pagination},on:{currentChange:e.currentChange,handleEdit:e.handleEdit,handleLog:e.handleLog,handleDelete:e.handleDelete}})],1):"log"===e.redirectType?n("customer-log-list",{attrs:{projectID:e.projectID,customerID:e.customerID,linkCode:e.linkCode},on:{close:e.closePage}}):e._e(),n("el-dialog",{attrs:{title:"审核",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("project-examine-edit",{attrs:{projectID:e.projectID,editID:e.editID},on:{close:e.dialogClose}})],1)],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[n("span",[e._v("客户项目审核列表")])])])}],i=n("a34a"),o=n.n(i),s=n("5c7f"),c=n("1a3a"),u=n("cd57"),l=n("4360"),f=n("93c2");function p(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){p(i,r,a,o,s,"next",e)}function s(e){p(i,r,a,o,s,"throw",e)}o(void 0)})}}var h={name:"CustomerProjectLists",components:{ProjectExamineEdit:c["default"],CustomerLogList:u["default"]},data:function(){return{currentPage:1,dialogFormVisible:!1,tableColumn:[{prop:"id",label:"id",width:100},{prop:"author",label:"申请人",width:100},{prop:"customer_name",label:"客户名",width:200},{prop:"project_name",label:"项目名",width:200},{prop:"reason",label:"原因",width:200},{prop:"status",label:"审核状态",type:"html",width:150},{prop:"result_reason",label:"驳回原因"},{prop:"create_time",label:"生成时间",width:200}],pagination:{pageTotal:0},tableData:[],operate:[{name:"审核",func:"handleEdit",type:"primary",auth:"审核项目"},{name:"日志",func:"handleLog",type:"danger",icon:"",auth:"审核项目"}],statusObj:{0:'<span style="color: #c75d6e;">审核不通过</span>',1:'<span style="color: #3963bc;">审核通过</span>',2:'<span style="color: orange;">正在审核中</span>'},showEdit:!1,loading:!1,editID:1,projectID:0,customerID:0,linkCode:0,redirectType:"list"}},created:function(){this.getTypes(),this.getProjectExamines()},methods:{getProjectExamines:function(){var e=d(o.a.mark(function e(){var t,n,r=this,a=arguments;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:0,this.loading=!0,n={},"super"!=l["default"].state.user.username&&!l["default"].state.auths.includes("全部项目信息")){e.next=9;break}return e.next=6,s["default"].getAllProjectExamine(t);case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,s["default"].getProjectExamines(t);case 11:n=e.sent;case 12:if(this.pagination.pageTotal&&this.pagination.pageTotal==n.total_nums||(this.pagination={pageTotal:n.total_nums}),!(n.total_nums<=0)){e.next=17;break}return this.tableData=[],this.loading=!1,e.abrupt("return");case 17:n.collection.forEach(function(e){e.status=r.statusObj[e.status]||"错误"}),this.loading=!1,this.tableData=n.collection;case 20:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),currentChange:function(e){e<=0||(e-=1,this.currentPage=e+1,this.getProjectExamines(e))},handleEdit:function(e){var t=e.row;this.editID=t.id,this.projectID=t.project_id,this.dialogFormVisible=!0},handleLog:function(e){var t=e.row;t.customer_id&&(this.customerID=t.customer_id),this.projectID=t.project_id,this.linkCode=t.link_code,this.editID=t.id,this.redirectType="log"},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d(o.a.mark(function n(){var r,a;return o.a.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return r=[e.row.id],t.loading=!0,n.next=4,Cultural.delCultural(r);case 4:a=n.sent,t.loading=!1,0===a.error_code&&(t.getCulturals(),t.$message({type:"success",message:"".concat(a.msg)}));case 7:case"end":return n.stop()}},n)})))},rowClick:function(){},closePage:function(e){this.redirectType="list",e&&this.getProjectExamines(this.currentPage-1)},getTypes:function(){var e=d(o.a.mark(function e(){var t,n,r,a,i,s,c=this;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(r in t=[],n=this.fieldObj,n)t.push(r);return t=t.join(),e.next=6,f["default"].getTypeByField(t);case 6:if(a=e.sent,a&&0!=a.length){e.next=9;break}return e.abrupt("return");case 9:for(s in i=function(e){var t=n[e],r=a.find(function(t){return t["field"]==e});r&&(c[t]=r["value"])},n)i(s);case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),dialogClose:function(){this.dialogFormVisible=!1,this.getProjectExamines(this.currentPage-1)}}},m=h,v=(n("5b93"),n("2877")),g=Object(v["a"])(m,r,a,!1,null,"07c07578",null);t["default"]=g.exports},6045:function(e,t,n){"use strict";n("0c77")},8542:function(e,t,n){}}]);