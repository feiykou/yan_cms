(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1e96d40","chunk-72655ce2","chunk-08306ed8","chunk-2d0b61e5"],{"1c96":function(t,e,n){"use strict";n.r(e);var r=n("a34a"),a=n.n(r),i=n("dfd8");n("f121");function s(t,e,n,r,a,i,s){try{var o=t[i](s),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(r,a)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(t){s(i,r,a,o,c,"next",t)}function c(t){s(i,r,a,o,c,"throw",t)}o(void 0)})}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}var m=function(){function t(){c(this,t)}return u(t,[{key:"importCustomerLog",value:function(){var t=o(a.a.mark(function t(e){var n,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n={},e&&e["raw"]){t.next=3;break}return t.abrupt("return");case 3:return n["file"]=e["raw"],console.log(n),t.next=7,Object(i["post"])("v1/excel/customer_log",n,{handleError:!0});case 7:return r=t.sent,console.log(r),t.abrupt("return",r);case 10:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"importCustomer",value:function(){var t=o(a.a.mark(function t(e){var n,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n={},e&&e["raw"]){t.next=3;break}return t.abrupt("return");case 3:return n["file"]=e["raw"],t.next=6,Object(i["post"])("v1/excel/customer",n,{handleError:!0});case 6:return r=t.sent,console.log(r),t.abrupt("return",r);case 9:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()}]),t}();e["default"]=new m},"27f7":function(t,e,n){},"4b78":function(t,e,n){"use strict";n("27f7")},"55b6":function(t,e,n){"use strict";n("7c54")},"7c54":function(t,e,n){},"84f0":function(t,e,n){"use strict";n("dbbb")},cd2a:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[t._v("编辑客户日志 "),n("span",{staticClass:"back",on:{click:function(e){return t.back(!1)}}},[n("i",{staticClass:"iconfont icon-fanhui"}),t._v(" 返回 ")])]),n("div",{staticClass:"wrap"},[n("el-row",[n("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,"status-icon":"",rules:t.rules,"label-width":"120px"},nativeOn:{submit:function(t){t.preventDefault()}}},[n("el-form-item",{attrs:{label:"日志名",prop:"name"}},[n("el-input",{attrs:{size:"medium",placeholder:"请填写日志名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"图片信息",prop:"img_urls"}},[n("upload-imgs",{ref:"uploadImgs",attrs:{multiple:!0,rules:t.imgRules,value:t.responseImg(t.form.img_urls),sortable:!0,maxNum:20}})],1),n("el-form-item",{attrs:{label:"日志状态",prop:"status"}},[n("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择日志状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[t._l(t.statusData,function(e,r){return[n("el-option",{key:e,attrs:{value:r,label:e}},[n("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[t._v(t._s(r+1))]),n("span",[t._v(t._s(e))])])]})],2)],1),n("el-form-item",{attrs:{label:"交流方式",prop:"commun_type"}},[n("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择交流方式"},model:{value:t.form.commun_type,callback:function(e){t.$set(t.form,"commun_type",e)},expression:"form.commun_type"}},[t._l(t.communtypeData,function(e,r){return[n("el-option",{key:e,attrs:{value:r,label:e}},[n("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[t._v(t._s(r+1))]),n("span",[t._v(t._s(e))])])]})],2)],1),n("el-form-item",{attrs:{label:"日志内容",prop:"content"}},[n("editor",{attrs:{id:"tinymce",init:t.editInit},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),n("el-form-item",{staticClass:"submit"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("保 存")]),n("el-button",{on:{click:function(e){return t.resetForm("form")}}},[t._v("重 置")])],1)],1)],1)],1)],1)])},a=[],i=n("a34a"),s=n.n(i),o=(n("0a3b"),n("cf74"),n("ca72")),c=(n("cf1d"),n("e0ba")),l=n("ae02"),u=n("306b");function m(t){return m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function f(t,e,n,r,a,i,s){try{var o=t[i](s),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(r,a)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function s(t){f(i,r,a,s,o,"next",t)}function o(t){f(i,r,a,s,o,"throw",t)}s(void 0)})}}var p={name:"CustomerLogEdit",props:{editID:Number},data:function(){return{content:"",statusData:["初步联系","见面拜访","停滞客户","成交客户","正式报价"],communtypeData:["见面拜访","微信","钉钉"],editInit:{selector:"#tinymce",language_url:"/tinymce/langs/zh_CN.js",language:"zh_CN",height:"400px",skin_url:"/tinymce/skins/ui/oxide"},value:"",imgRules:{minWidth:100,minHeight:100,maxSize:5},loading:!1,columnData:[],cateData:[],form:{name:"",content:""},rules:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],content:[{required:!0,message:"请输入日志内容",trigger:"blur"}]}}},components:{UploadImgs:c["default"],Editor:o["a"]},created:function(){this._initialize()},methods:{_initialize:function(){this.getCustomerLog()},getCustomerLog:function(){var t=d(s.a.mark(function t(){var e;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,l["default"].getCustomerLog(this.editID);case 4:e=t.sent,this.form=e,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),this.back(!1);case 11:this.loading=!1;case 12:case"end":return t.stop()}},t,this,[[1,8]])}));function e(){return t.apply(this,arguments)}return e}(),submitForm:function(t){var e=this;this.$refs[t].validate(function(){var t=d(s.a.mark(function t(n){var r,a,i,o;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=30;break}return e.loading=!0,t.prev=2,t.next=5,e.$refs.uploadImgs.getValue();case 5:return r=t.sent,e.form["img_urls"]=u["default"].solveUploadMultipleImg(r),t.next=9,l["default"].editCustomerLog(e.editID,e.form);case 9:a=t.sent,0===a.error_code&&(e.$message.success("".concat(a.msg)),e.back()),t.next=27;break;case 13:if(t.prev=13,t.t0=t["catch"](2),console.log(e.form),console.log(t.t0),i=t.t0.data.msg,!i||"object"!==m(i)){t.next=27;break}t.t1=s.a.keys(i);case 20:if((t.t2=t.t1()).done){t.next=27;break}return o=t.t2.value,e.$message.error(i[o]),t.next=25,setTimeout(function(){},1e3);case 25:t.next=20;break;case 27:e.loading=!1,t.next=32;break;case 30:return e.$message.error("请填写正确的信息"),t.abrupt("return",!1);case 32:case"end":return t.stop()}},t,null,[[2,13]])}));return function(e){return t.apply(this,arguments)}}())},_handleCustomerResData:function(t){},resetForm:function(t){this.$refs[t].resetFields()},back:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",t)},responseImg:function(t){if(t&&"undefined"!=t)return u["default"].solveReponseMultipleImg(t)}}},g=p,h=(n("4b78"),n("cba8")),v=Object(h["a"])(g,r,a,!1,null,"1236a7f0",null);e["default"]=v.exports},cd57:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["list"===t.redirectType?n("div",{staticClass:"container"},[n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[n("span",[t._v("客户日志列表")]),t.hideLogBtn?t._e():n("div",{staticClass:"log-action-btn"},[n("el-button",{staticClass:"add-banner-item",attrs:{type:"primary",plain:""},on:{click:t.handleAdd}},[t._v("添加客户日志")]),n("el-upload",{staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","on-change":t.handleChange,"file-list":t.fileList}},[n("el-button",{attrs:{size:"small",type:"primary"}},[t._v("导入excel数据")])],1)],1)]),n("span",{staticClass:"back",on:{click:function(e){return t.back(!1)}}},[n("i",{staticClass:"iconfont icon-fanhui"}),t._v(" 返回 ")])]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"block"},[n("el-timeline",t._l(t.tableData,function(e,r){return n("el-timeline-item",{key:r,attrs:{timestamp:t._f("dataFormal")(e.create_time),placement:"top"}},[n("el-card",[n("div",{staticClass:"log-block"},[n("div",{staticClass:"log-content"},[n("div",{staticClass:"log-wrap"},[n("h4",{staticClass:"tit"},[t._v(t._s(e.name))]),n("p",{staticClass:"desc",domProps:{innerHTML:t._s(e.content)}})]),n("div",{staticClass:"imgs-upload-container"},t._l(e.img_urls,function(r,a){return n("div",{key:a,staticClass:"img-box",on:{click:function(n){return t.preview(e.id,a)}}},[n("el-image",{staticClass:"thumb-item-img",staticStyle:{width:"100%",height:"100%"},attrs:{src:r.src,fit:"cover"}}),n("div",{staticClass:"control"},[n("div",{staticClass:"preview"},[n("i",{staticClass:"el-icon-view"})])])],1)}),0),n("p",{staticClass:"author-label"},[t._v(t._s(e.author)+" 提交于 "+t._s(e.create_time))])]),t.hideLogBtn?t._e():n("div",{staticClass:"action-wrap"},[n("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(n){return t.handleEdit(e.id)}}},[t._v("编辑")]),n("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(n){return t.handleDelete(e.id)}}},[t._v("删除")])],1)])])],1)}),1),n("div",{staticClass:"result-wrap"},[t._v("暂无数据")])],1)]):"add"===t.redirectType?n("customer-log-add",{attrs:{customerID:t.customerID},on:{close:t.closePage}}):"edit"===t.redirectType?n("customer-log-edit",{attrs:{editID:t.editID},on:{close:t.closePage}}):t._e()],1)},a=[],i=n("a34a"),s=n.n(i),o=n("ea6d"),c=n("cd2a"),l=n("ae02"),u=n("1c96");function m(t,e,n,r,a,i,s){try{var o=t[i](s),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(r,a)}function f(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function s(t){m(i,r,a,s,o,"next",t)}function o(t){m(i,r,a,s,o,"throw",t)}s(void 0)})}}var d={props:{customerID:Number,hideLogBtn:Boolean},filters:{dataFormal:function(t){if(!t)return"";var e=t.split(" ");return e.length>=1?e[0]:""}},data:function(){return{redirectType:"list",tableData:[],fileList:[],editID:1,pagination:{pageTotal:0},urls:{},thumbs:{}}},components:{CustomerLogAdd:o["default"],CustomerLogEdit:c["default"]},created:function(){this.getCustomerLogs()},methods:{importCustomerLog:function(){var t=f(s.a.mark(function t(e){var n;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,u["default"].importCustomerLog(e);case 3:n=t.sent,this.loading=!1,0===n.error_code&&this.$message({type:"success",message:"".concat(n.msg)});case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),handleChange:function(){var t=f(s.a.mark(function t(e,n){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e),t.next=3,this.importCustomerLog(e);case 3:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),solveImgPreview:function(){this.urls={},this.thumbs={};var t={},e=[];this.tableData.length<=0||(this.tableData.forEach(function(n){e=[],n.img_urls&&(n.img_urls.forEach(function(t){e.push(t.src)}),t["id"+n.id]=e)}),this.thumbs=this.urls=t)},getCustomerLogs:function(){var t=f(s.a.mark(function t(){var e,n,r=arguments;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:0,this.loading=!0,t.next=4,l["default"].getCustomerLogs(this.customerID,e);case 4:if(n=t.sent,!(n&&n.total_nums<=0)){t.next=9;break}return this.tableData=[],this.loading=!1,t.abrupt("return");case 9:this.pagination.pageTotal||(this.pagination={pageTotal:n.total_nums}),this.tableData=n.collection,this.solveImgPreview(),this.loading=!1;case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),currentChange:function(t){t<=0||(t-=1,this.currentPage=t+1,this.getCustomerLogs(t))},preview:function(t,e){this.thumbs=this.urls["id"+t],this.$imagePreview({images:this.urls["id"+t],index:e})},handleAdd:function(){this.redirectType="add"},handleEdit:function(t){this.redirectType="edit",console.log(t),this.editID=t},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该客户日志, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(f(s.a.mark(function n(){var r;return s.a.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,n.next=3,l["default"].delCustomerLog(t);case 3:r=n.sent,e.loading=!1,0===r.error_code&&(e.getCustomerLogs(e.currentPage-1),e.$message({type:"success",message:"".concat(r.msg)}));case 6:case"end":return n.stop()}},n)})))},back:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",t)},closePage:function(t){this.redirectType="list",t&&this.getCustomerLogs(this.currentPage-1)}}},p=d,g=(n("55b6"),n("cba8")),h=Object(g["a"])(p,r,a,!1,null,"4ce29b28",null);e["default"]=h.exports},dbbb:function(t,e,n){},ea6d:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[t._v("添加客户日志 "),n("span",{staticClass:"back",on:{click:function(e){return t.back(!1)}}},[n("i",{staticClass:"iconfont icon-fanhui"}),t._v(" 返回 ")])]),n("div",{staticClass:"wrap"},[n("el-row",[n("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{model:t.form,"status-icon":"",rules:t.rules,"label-width":"120px"},nativeOn:{submit:function(t){t.preventDefault()}}},[n("el-form-item",{attrs:{label:"日志名",prop:"name"}},[n("el-input",{attrs:{size:"medium",placeholder:"请填写日志名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"图片信息",prop:"img_urls"}},[n("upload-imgs",{ref:"uploadImgs",attrs:{multiple:!0,rules:t.imgRules,maxNum:20}})],1),n("el-form-item",{attrs:{label:"日志状态",prop:"status"}},[n("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择日志状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[t._l(t.statusData,function(e,r){return[n("el-option",{key:e,attrs:{value:r,label:e}},[n("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[t._v(t._s(r+1))]),n("span",[t._v(t._s(e))])])]})],2)],1),n("el-form-item",{attrs:{label:"交流方式",prop:"commun_type"}},[n("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择交流方式"},model:{value:t.form.commun_type,callback:function(e){t.$set(t.form,"commun_type",e)},expression:"form.commun_type"}},[t._l(t.communtypeData,function(e,r){return[n("el-option",{key:e,attrs:{value:r,label:e}},[n("span",{staticStyle:{color:"#b4b4b4","margin-right":"15px","font-size":"12px"}},[t._v(t._s(r+1))]),n("span",[t._v(t._s(e))])])]})],2)],1),n("el-form-item",{attrs:{label:"日志内容",prop:"content"}},[n("editor",{attrs:{id:"tinymce",init:t.editInit},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),n("el-form-item",{staticClass:"submit"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("保 存")]),n("el-button",{on:{click:function(e){return t.resetForm("form")}}},[t._v("重 置")])],1)],1)],1)],1)],1)])},a=[],i=n("a34a"),s=n.n(i),o=(n("0a3b"),n("cf74"),n("ca72")),c=(n("cf1d"),n("e0ba")),l=n("ae02"),u=n("306b");function m(t){return m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function f(t,e,n,r,a,i,s){try{var o=t[i](s),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(r,a)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function s(t){f(i,r,a,s,o,"next",t)}function o(t){f(i,r,a,s,o,"throw",t)}s(void 0)})}}var p={name:"CustomerLogAdd",props:{customerID:Number},components:{UploadImgs:c["default"],Editor:o["a"]},data:function(){return{content:"",statusData:["初步联系","见面拜访","停滞客户","成交客户","正式报价"],communtypeData:["见面拜访","微信","钉钉"],editInit:{selector:"#tinymce",mobile:{menubar:!0},language_url:"/tinymce/langs/zh_CN.js",language:"zh_CN",height:"400px",skin_url:"/tinymce/skins/ui/oxide"},value:"",imgRules:{minWidth:100,minHeight:100,maxSize:5},loading:!1,columnData:[],cateData:[],form:{name:"",content:""},rules:{name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],content:[{required:!0,message:"请输入日志内容",trigger:"blur"}]}}},created:function(){},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(){var n=d(s.a.mark(function n(r){var a,i,o,c;return s.a.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(!r){n.next=29;break}return e.loading=!0,n.prev=2,n.next=5,e.$refs.uploadImgs.getValue();case 5:return a=n.sent,e.form["img_urls"]=u["default"].solveUploadMultipleImg(a),e.form["customer_id"]=e.customerID,n.next=10,l["default"].addCustomerLog(e.form);case 10:i=n.sent,0===i.error_code&&(e.$message.success("".concat(i.msg)),e.resetForm(t),e.back()),n.next=26;break;case 14:if(n.prev=14,n.t0=n["catch"](2),o=n.t0.data.msg,!o||"object"!==m(o)){n.next=26;break}n.t1=s.a.keys(o);case 19:if((n.t2=n.t1()).done){n.next=26;break}return c=n.t2.value,e.$message.error(o[c]),n.next=24,setTimeout(function(){},1e3);case 24:n.next=19;break;case 26:e.loading=!1,n.next=31;break;case 29:return e.$message.error("请填写正确的信息"),n.abrupt("return",!1);case 31:case"end":return n.stop()}},n,null,[[2,14]])}));return function(t){return n.apply(this,arguments)}}())},resetForm:function(t){this.$refs[t].resetFields()},back:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$emit("close",t)}}},g=p,h=(n("84f0"),n("cba8")),v=Object(h["a"])(g,r,a,!1,null,"360073b4",null);e["default"]=v.exports}}]);